var p=(l,G,m)=>new Promise((n,_)=>{var y=r=>{try{g(m.next(r))}catch(f){_(f)}},T=r=>{try{g(m.throw(r))}catch(f){_(f)}},g=r=>r.done?n(r.value):Promise.resolve(r.value).then(y,T);g((m=m.apply(l,G)).next())});import{u as ce,R as de,M as pe}from"./index.es-BVwDNJs5.mjs";import{r as M,S as me,D as B,E as _e,e as fe}from"./bootstrap-t35vpcz_.mjs";import{_ as ve}from"./ClientForm.vue_vue_type_script_setup_true_lang-tIxIl9XN.mjs";import{a6 as Ce,P as v,J as R,aF as o,aG as d,aJ as U,m as t,aI as a,aa as i,ao as C,h as O,aH as S,F as L,aY as V,aW as J,aX as ye}from"../jse/index-index-CqEm-tRS.mjs";const $={Page:"/api/v1/oauth2/client/page",Get:"/api/v1/oauth2/client/get",PUT:"/api/v1/oauth2/client",Delete:"/api/v1/oauth2/client/del"};function ge(l){return p(this,null,function*(){return M.post($.Page,l)})}function he(l){return p(this,null,function*(){return M.delete($.Delete,{params:{id:l}})})}function ke(l){return p(this,null,function*(){return M.put($.PUT,l)})}function Ie(l){return p(this,null,function*(){return ge(l)})}function Se(l){return p(this,null,function*(){return ke(l)})}function be(l){return p(this,null,function*(){return he(l)})}const Ne={style:{"overflow-y":"scroll"}},Ge=Ce({__name:"clientlist",setup(l){const G=[{title:"Id",dataIndex:"id",key:"id",sorter:!0,defaultSortOrder:"ascend"},{title:"Enabled",dataIndex:"Enabled",key:"Enabled",sorter:!0},{title:"ClientName",dataIndex:"ClientName",key:"ClientName",name:"client_name",sorter:!0,filtered:!0},{title:"ClientId",dataIndex:"ClientId",key:"client_id",sorter:!0,filtered:!0},{title:"Scopes",dataIndex:"Scopes",key:"Scopes",sorter:!0,filtered:!0},{title:"GrantTypes",dataIndex:"GrantTypes",key:"GrantTypes",sorter:!0,filtered:!0},{title:"Actions",key:"action"}],m=v(),n=v({ClientId:"",ClientName:""}),_=v("id"),y=v("asc"),T=R(()=>{const e=[];return n.value.ClientId!==""&&e.push("Client_Id like ?"),n.value.ClientName!==""&&e.push("Client_Name like ?"),e}),g=R(()=>{const e=[];return n.value.ClientId!==""&&e.push(`%${n.value.ClientId}%`),n.value.ClientName!==""&&e.push(`%${n.value.ClientName}%`),e}),{data:r,run:f,refresh:K,loading:A,total:H,current:z,pageSize:E}=ce(Ie,{defaultParams:{page:1,pageSize:10,sortField:"id",sortOrder:"asc",filters:T,args:g},pagination:{currentKey:"page",pageSizeKey:"pageSize"}}),W={Id:"id",ClientName:"Client_Name",ClientId:"Client_Id",GrantTypes:"Grant_Types"},X=R(()=>({total:H.value,current:z.value,pageSize:E.value})),w=()=>{setTimeout(()=>{K()},50)},Y=()=>{console.log("searchModel",n.value),setTimeout(()=>{f({page:z.value,pageSize:E.value,sortField:_.value,sortOrder:y.value,filters:T,args:g})},500)},j=()=>{n.value={ClientId:"",ClientName:""},m.value.resetFields(),w()},h=v(!1),F=v(),x=v(),Q=e=>{F.value=e,h.value=!0},Z=e=>{be(e),w()},ee=()=>p(this,null,function*(){try{const e=yield x.value.validate();if(!e)return;console.log("form validate",e)}catch(e){console.log("error submit:",e);return}Se(F.value),h.value=!1,w()}),te=()=>{x.value.resetForm(),h.value=!1},ae=()=>{F.value={Id:0,Enabled:!0,ClientId:"",ClientName:"",GrantTypes:"authorization_code",Scopes:"openid",RequireConsent:!0,RequirePkce:!1,RequireSecret:!0,RedirectUris:"http://localhost:8080/signin-oidc"},h.value=!0},ne=(e,c,k)=>{var b;z.value=e.current,E.value=e.pageSize,k.field?(_.value=(b=W[k.field])!=null?b:k.field,y.value=k.order):(_.value="Id",y.value="asc"),console.log("filter",c),f({page:z.value,pageSize:E.value,sortField:_.value,sortOrder:y.value,filter:c})};return(e,c)=>{const k=o("a-page-header"),b=o("a-input"),D=o("a-form-item"),N=o("a-button"),le=o("a-form"),oe=o("a-divider"),ie=o("a-popconfirm"),P=o("a-space"),re=o("a-switch"),q=o("a-tag"),se=o("a-table"),ue=o("a-modal");return d(),U("div",Ne,[t(k,{"sub-title":"Client list page",title:"Clients"}),t(le,{ref_key:"searchForm",ref:m,model:n.value,layout:"inline"},{default:a(()=>[t(D,{label:"ClientId"},{default:a(()=>[t(b,{value:n.value.ClientId,"onUpdate:value":c[0]||(c[0]=s=>n.value.ClientId=s),placeholder:"ClientId"},null,8,["value"])]),_:1}),t(D,{label:"ClientName"},{default:a(()=>[t(b,{value:n.value.ClientName,"onUpdate:value":c[1]||(c[1]=s=>n.value.ClientName=s),placeholder:"ClientName"},null,8,["value"])]),_:1}),t(D,null,{default:a(()=>[t(N,{type:"primary",onClick:Y},{icon:a(()=>[t(i(me))]),default:a(()=>[C(" Search ")]),_:1}),t(N,{icon:O(i(de)),type:"primary",onClick:j},{default:a(()=>[C(" Reset ")]),_:1},8,["icon"]),t(i(B),{type:"vertical"}),t(N,{icon:O(i(pe)),type:"primary",onClick:ae},{default:a(()=>[C(" New ")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),t(oe,{type:"horizontal"}),t(se,{columns:G,"data-source":i(r)?i(r).list:null,loading:i(A),pagination:X.value,run:i(f),onChange:ne},{bodyCell:a(({column:s,record:I})=>[s.key==="action"?(d(),S(P,{key:0},{default:a(()=>[t(N,{icon:O(i(_e)),type:"primary",onClick:u=>Q(I)},{default:a(()=>[C(" Edit ")]),_:2},1032,["icon","onClick"]),t(i(B),{type:"vertical"}),t(ie,{title:"Delete Client  ",onConfirm:u=>Z(I.id)},{default:a(()=>[t(N,{icon:O(i(fe)),danger:""},{default:a(()=>[C("Delete")]),_:1},8,["icon"])]),_:2},1032,["onConfirm"])]),_:2},1024)):s.key==="Enabled"?(d(),S(re,{key:1,checked:I.Enabled,"onUpdate:checked":u=>I.Enabled=u,enabled:"false",size:"small"},null,8,["checked","onUpdate:checked"])):s.key==="Scopes"?(d(),S(P,{key:2,size:"small",wrap:""},{default:a(()=>[(d(!0),U(L,null,V(I.Scopes.split(" "),u=>(d(),S(q,{key:u,color:"blue"},{default:a(()=>[C(J(u),1)]),_:2},1024))),128))]),_:2},1024)):s.key==="GrantTypes"?(d(),S(P,{key:3,size:"small",wrap:""},{default:a(()=>[(d(!0),U(L,null,V(I.GrantTypes.split(" "),u=>(d(),S(q,{key:u,color:"geekblue"},{default:a(()=>[C(J(u==="urn:ietf:params:oauth:grant-type:device_code"?"device code":u),1)]),_:2},1024))),128))]),_:2},1024)):ye("",!0)]),_:1},8,["data-source","loading","pagination","run"]),t(ue,{open:h.value,"onUpdate:open":c[2]||(c[2]=s=>h.value=s),title:"Edit Client Info",onCancel:te,onOk:ee},{default:a(()=>[t(ve,{ref_key:"clientForm",ref:x,client:F.value},null,8,["client"])]),_:1},8,["open"])])}}});export{Ge as default};
