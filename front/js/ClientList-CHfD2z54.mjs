var u=(n,O,d)=>new Promise((a,p)=>{var C=i=>{try{f(d.next(i))}catch(m){p(m)}},I=i=>{try{f(d.throw(i))}catch(m){p(m)}},f=i=>i.done?a(i.value):Promise.resolve(i.value).then(C,I);f((d=d.apply(n,O)).next())});import{u as le,R as oe,M as ie}from"./index.es-cKQJCCjf.mjs";import{r as U,S as re,D as M,E as ce,e as se,M as ue,f as de}from"./bootstrap-OcJ_7BUG.mjs";import{_ as pe}from"./ClientForm.vue_vue_type_script_setup_true_lang-De0U8sdH.mjs";import{a6 as me,P as v,J as P,aF as r,aG as R,aJ as ve,m as t,aI as l,aa as o,ao as k,h as E,aH as $,aX as Ce}from"../jse/index-index-CWuPeoDv.mjs";const G={Page:"/api/v1/oauth2/client/page",Get:"/api/v1/oauth2/client/get",PUT:"/api/v1/oauth2/client",Delete:"/api/v1/oauth2/client/del"};function fe(n){return u(this,null,function*(){return U.post(G.Page,n)})}function _e(n){return u(this,null,function*(){return U.delete(G.Delete,{params:{id:n}})})}function ye(n){return u(this,null,function*(){return U.put(G.PUT,n)})}function ge(n){return u(this,null,function*(){return fe(n)})}function he(n){return u(this,null,function*(){return ye(n)})}function ke(n){return u(this,null,function*(){return _e(n)})}const Ie={class:"p-5"},Oe=me({__name:"ClientList",setup(n){const O=[{title:"Id",dataIndex:"Id",key:"Id",sorter:!0,defaultSortOrder:"ascend"},{title:"Enabled",dataIndex:"Enabled",key:"Enabled",sorter:!0},{title:"ClientName",dataIndex:"ClientName",key:"ClientName",name:"client_name",sorter:!0,filtered:!0},{title:"ClientId",dataIndex:"ClientId",key:"client_id",sorter:!0,filtered:!0},{title:"Scopes",dataIndex:"Scopes",key:"Scopes",sorter:!0,filtered:!0},{title:"GrantTypes",dataIndex:"GrantTypes",key:"GrantTypes",sorter:!0,filtered:!0},{title:"Actions",key:"action"}],d=v(),a=v({ClientId:"",ClientName:""}),p=v("Id"),C=v("asc"),I=P(()=>{const e=[];return a.value.ClientId!==""&&e.push("Client_Id like ?"),a.value.ClientName!==""&&e.push("Client_Name like ?"),e}),f=P(()=>{const e=[];return a.value.ClientId!==""&&e.push(`%${a.value.ClientId}%`),a.value.ClientName!==""&&e.push(`%${a.value.ClientName}%`),e}),{data:i,run:m,refresh:w,loading:q,total:B,current:b,pageSize:N}=le(ge,{defaultParams:{page:1,pageSize:10,sortField:"Id",sortOrder:"asc",filters:I,args:f},pagination:{currentKey:"page",pageSizeKey:"pageSize"}}),L={Id:"Id",ClientName:"Client_Name",ClientId:"Client_Id"},V=P(()=>({total:B.value,current:b.value,pageSize:N.value})),F=()=>{setTimeout(()=>{w()},50)},A=()=>{console.log("searchModel",a.value),setTimeout(()=>{m({page:b.value,pageSize:N.value,sortField:p.value,sortOrder:C.value,filters:I,args:f})},500)},J=()=>{a.value={ClientId:"",ClientName:""},d.value.resetFields(),F()},_=v(!1),S=v(),T=v(),K=e=>{S.value=e,_.value=!0},H=e=>{ue.confirm({title:`Deleting Client ${e}`,icon:de,content:`Are you sure delete this client ${e}?`,onOk(){ke(e),F()},onCancel(){console.log("Cancel")}}),console.log("record",e)},X=()=>u(this,null,function*(){try{const e=yield T.value.validate();if(!e)return;console.log("form validate",e)}catch(e){console.log("error submit:",e);return}he(S.value),_.value=!1,F()}),j=()=>{T.value.resetForm(),_.value=!1},Q=()=>{S.value={Id:0,Enabled:!0,ClientId:"",ClientName:"",GrantTypes:"authorization_code",Scopes:"openid",RequireConsent:!0,RequirePkce:!1,RequireSecret:!0,RedirectUris:"http://localhost:8080/signin-oidc"},_.value=!0},W=(e,c,y)=>{var g;b.value=e.current,N.value=e.pageSize,y.field?(p.value=(g=L[y.field])!=null?g:y.field,C.value=y.order):(p.value="Id",C.value="asc"),console.log("filter",c),m({page:b.value,pageSize:N.value,sortField:p.value,sortOrder:C.value,filter:c})};return(e,c)=>{const y=r("a-page-header"),g=r("a-input"),z=r("a-form-item"),h=r("a-button"),Y=r("a-form"),Z=r("a-divider"),ee=r("a-space"),te=r("a-checkbox"),ae=r("a-table"),ne=r("a-modal");return R(),ve("div",Ie,[t(y,{style:{border:"1px solid rgb(235 237 240)"},"sub-title":"Client list page",title:"Clients"}),t(Y,{ref_key:"searchForm",ref:d,model:a.value,layout:"inline"},{default:l(()=>[t(z,{label:"ClientId"},{default:l(()=>[t(g,{value:a.value.ClientId,"onUpdate:value":c[0]||(c[0]=s=>a.value.ClientId=s),placeholder:"ClientId"},null,8,["value"])]),_:1}),t(z,{label:"ClientName"},{default:l(()=>[t(g,{value:a.value.ClientName,"onUpdate:value":c[1]||(c[1]=s=>a.value.ClientName=s),placeholder:"ClientName"},null,8,["value"])]),_:1}),t(z,null,{default:l(()=>[t(h,{type:"primary",onClick:A},{icon:l(()=>[t(o(re))]),default:l(()=>[k(" Search ")]),_:1}),t(h,{icon:E(o(oe)),type:"primary",onClick:J},{default:l(()=>[k(" Reset ")]),_:1},8,["icon"]),t(o(M),{type:"vertical"}),t(h,{icon:E(o(ie)),type:"primary",onClick:Q},{default:l(()=>[k(" New ")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),t(Z,{type:"horizontal"}),t(ae,{columns:O,"data-source":o(i)?o(i).list:null,loading:o(q),pagination:V.value,run:o(m),onChange:W},{bodyCell:l(({column:s,record:x})=>[s.key==="action"?(R(),$(ee,{key:0},{default:l(()=>[t(h,{icon:E(o(ce)),type:"primary",onClick:D=>K(x)},{default:l(()=>[k(" Edit ")]),_:2},1032,["icon","onClick"]),t(o(M),{type:"vertical"}),t(h,{icon:E(o(se)),danger:"",onClick:D=>H(x.Id)},{default:l(()=>[k(" Delete ")]),_:2},1032,["icon","onClick"])]),_:2},1024)):s.key==="Enabled"?(R(),$(te,{key:1,checked:x.Enabled,"onUpdate:checked":D=>x.Enabled=D},null,8,["checked","onUpdate:checked"])):Ce("",!0)]),_:1},8,["data-source","loading","pagination","run"]),t(ne,{open:_.value,"onUpdate:open":c[2]||(c[2]=s=>_.value=s),title:"Edit Client Info",onCancel:j,onOk:X},{default:l(()=>[t(pe,{ref_key:"clientForm",ref:T,client:S.value},null,8,["client"])]),_:1},8,["open"])])}}});export{Oe as default};
